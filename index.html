<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ½é¸å™¨</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e67e22;
            --success: #27ae60;
            --bg: #f4f7f6;
            --card: #ffffff;
        }
        body { font-family: sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; color: #333; }
        
        .main-card { width: 100%; max-width: 600px; background: var(--card); padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { text-align: center; margin-top: 0; color: var(--primary); }

        .input-section { margin-bottom: 20px; }
        label { font-weight: bold; font-size: 0.9rem; display: block; margin-bottom: 8px; }
        textarea { width: 100%; height: 100px; padding: 12px; border: 2px solid #ddd; border-radius: 10px; box-sizing: border-box; resize: vertical; font-size: 0.9rem; }
        
        .settings { display: flex; align-items: center; gap: 15px; margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 8px; }
        input[type="number"] { width: 60px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; text-align: center; font-weight: bold; }

        /* ã‚¹ãƒ­ãƒƒãƒˆã‚¨ãƒªã‚¢ */
        .slot-container { display: flex; flex-direction: column; gap: 10px; margin: 20px 0; }
        .slot-row { 
            display: flex; align-items: center; background: #222; height: 50px; 
            border-radius: 8px; overflow: hidden; position: relative; border: 2px solid #444;
            transition: border-color 0.2s;
        }
        /* æŠ½é¸ä¸­ã®æ ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰ */
        .slot-row.active { border-color: var(--accent); box-shadow: 0 0 10px rgba(230, 126, 34, 0.4); }
        /* ç¢ºå®šå¾Œã®æ ï¼ˆç·‘ï¼‰ */
        .slot-row.done { border-color: var(--success); background: #1a1a1a; }
        
        .slot-label { width: 80px; background: #333; color: #888; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: bold; border-right: 1px solid #444; transition: color 0.2s; }
        .slot-row.done .slot-label { color: var(--success); }

        .slot-viewport { flex-grow: 1; height: 50px; position: relative; overflow: hidden; }
        .slot-item { height: 50px; line-height: 50px; color: #fff; font-weight: bold; font-size: 1.1rem; text-align: center; }
        .empty-text { color: #555; font-style: italic; font-weight: normal; }

        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .btn-main { 
            width: 100%; padding: 18px; border: none; border-radius: 50px; 
            background: var(--accent); color: white; font-size: 1.2rem; font-weight: bold; 
            cursor: pointer; transition: transform 0.1s, background 0.2s;
            box-shadow: 0 4px 0 #bc661b;
        }
        .btn-main:hover { background: #cf711f; }
        .btn-main:active { transform: translateY(2px); box-shadow: 0 2px 0 #bc661b; }
        .btn-main:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; transform: none; }

        /* çµæœã‚³ãƒ”ãƒ¼ */
        .result-area { margin-top: 20px; display: none; background: #f9f9f9; padding: 15px; border-radius: 10px; border: 1px dashed #bbb; }
        .result-text { font-weight: bold; text-align: center; white-space: pre-wrap; margin-bottom: 10px; }
        .btn-copy { width: 100%; padding: 10px; border: none; border-radius: 5px; background: var(--primary); color: white; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="main-card">
    <h2>ğŸ† å‚åŠ è€…æŠ½é¸ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h2>

    <div class="input-section">
        <label>å‚åŠ è€…ãƒªã‚¹ãƒˆ</label>
        <textarea id="name-list" placeholder="1è¡Œã«1äººãšã¤å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
        <div class="settings">
            <label>å½“é¸äººæ•°:</label>
            <input type="number" id="pick-count" value="5" min="1" max="100">
            <span style="margin-left: auto; font-size: 0.8rem; color: #666;" id="list-count-info">0äººå…¥åŠ›æ¸ˆã¿</span>
        </div>
    </div>

    <div id="slot-display" class="slot-container"></div>

    <button id="spin-btn" class="btn-main" onclick="startLottery()">æŠ½é¸é–‹å§‹ï¼</button>

    <div id="result-wrapper" class="result-area">
        <div id="result-text" class="result-text"></div>
        <button class="btn-copy" onclick="copyResult()">ğŸ“‹ çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
</div>

<script>
    const nameInput = document.getElementById('name-list');
    const countInput = document.getElementById('pick-count');
    const infoSpan = document.getElementById('list-count-info');
    const slotContainer = document.getElementById('slot-display');
    let isSpinning = false;

    const samples = [
        "LVH / rikka", "MingiGod", "ãƒã‚°ãŸã‚“", "Wave | æ€’ç‹", "ã‚†ã†ã¡ã‚‡/ASL", "y(@Bonr1979)", "salty", "æ¼†é»’",
        "ã‚¢ãƒ¬ã‚¯ã‚µãƒ³ãƒ€ãƒ¼", "ã‚ã¨", "ã†ãŒã„", "ä¸­ç”°", "Mizo.", "ã½ã“ã½ã“ãŸ", "ã‚¢ãƒ«ã‚«ãƒ³ã‚·ã‚§ãƒ«", "ã‚·ãƒ‰ãƒ‹ãƒ¼",
        "ãªãŠã@ã‚ªã‚¿ã‚¯DMP", "ã‚‹ã´ã‚", "ttt", "ã„ã‚ã¯", "ã‚­ãƒ£ãƒªãƒ¼", "ã¼ãƒ¼ã„ã‚“", "ãŸã ã®ãƒ¡ã‚¬ãƒ", "ã­ã‚€ã‚‹",
        "ã™ãƒ¼", "ãƒ¬ãƒ¬ãƒ‘", "y(@yogu3645)", "ã‚", "æ¡è—¤ãƒŠã‚®ã‚µ", "Winter", "imagin", "canon", "rainy lady", "ã‚ã‚“ã‹ã‘",
        "ã‚‰ã‚‰ã‚‰", "ã†ã¿ã­", "ãŸãã†ã¾", "miffy_kotone", "ç™½æ ¹æ´¸", "siro", "ã‚·ãƒ³", "ã¯ã¾ã˜ã‚€ã•ã—",
        "ã‚¨ã‚¢ãƒ¼ãƒãƒ³@Vtuber", "ãšã„ãšã„ç‘é¶´", "ã‚ãŸ", "ã¿ãªã·", "ã‚ã®äººã®ãŠå¯¿å¸", "ã™ã‹ã„ãƒãƒ", "ã„ãã«ã™",
        "ã´ãˆ", "Sakii", "kibel", "hamachan", "è™šç„¡ã¡ã‚“", "orca", "Î±", "ã‚½ã‚¦ã‚¿", "åxç´ä¹ƒè‘‰é›ªä¹ƒxå",
        "ãªã¿ã¡ã‚ƒ", "ãˆãã‚Œã‚", "å®‰è—¤", "ç«œç‹", "ã¨ã‚ã‚‹", "ãŸã‚“ã¼"
    ];
    nameInput.value = samples.join('\n');

    function init() {
        updateInfo();
        refreshSlots();
        nameInput.addEventListener('input', updateInfo);
        countInput.addEventListener('input', refreshSlots);
    }

    function getNames() {
        return nameInput.value.split(/[ã€,\n]/).map(s => s.trim()).filter(s => s !== "");
    }

    function updateInfo() {
        const list = getNames();
        infoSpan.innerText = `${list.length}äººå…¥åŠ›æ¸ˆã¿`;
    }

    // æ ã®çŠ¶æ…‹ã‚’åˆæœŸåŒ–ã™ã‚‹ï¼ˆç™½æ–‡å­—ãƒ»å¾…æ©Ÿä¸­ã«æˆ»ã™ï¼‰
    function refreshSlots() {
        if (isSpinning) return;
        const count = parseInt(countInput.value) || 0;
        slotContainer.innerHTML = '';
        for (let i = 0; i < count; i++) {
            slotContainer.innerHTML += `
                <div class="slot-row" id="row-${i}">
                    <div class="slot-label">å½“é¸ ${i+1}</div>
                    <div class="slot-viewport">
                        <div class="slot-item empty-text" id="list-${i}" style="color: #fff">å¾…æ©Ÿä¸­...</div>
                    </div>
                </div>
            `;
        }
        document.getElementById('result-wrapper').style.display = 'none';
    }

    async function startLottery() {
        if (isSpinning) return;
        
        const allNames = getNames();
        const pickNum = parseInt(countInput.value);

        if (allNames.length < pickNum) {
            alert(`å‚åŠ è€…ãŒè¶³ã‚Šã¾ã›ã‚“ï¼ï¼ˆç¾åœ¨${allNames.length}å / å¿…è¦${pickNum}åï¼‰`);
            return;
        }

        isSpinning = true;
        document.getElementById('spin-btn').disabled = true;
        document.getElementById('result-wrapper').style.display = 'none';
        
        // ã€ä¿®æ­£ç®‡æ‰€ã€‘æŠ½é¸é–‹å§‹æ™‚ã«ã€å…¨ã‚¹ãƒ­ãƒƒãƒˆã‚’ä¸€æ—¦ã€Œç™½æ–‡å­—ã®å›è»¢çŠ¶æ…‹ã€ã«ãƒªã‚»ãƒƒãƒˆ
        for (let i = 0; i < pickNum; i++) {
            const rowEl = document.getElementById(`row-${i}`);
            const listEl = document.getElementById(`list-${i}`);
            if (rowEl && listEl) {
                rowEl.classList.remove('done');
                rowEl.classList.add('active');
                listEl.classList.remove('empty-text');
                listEl.style.color = "#fff"; // æ–‡å­—è‰²ã‚’ç™½ã«æˆ»ã™
                listEl.innerText = "æŠ½é¸ä¸­...";
            }
        }

        const shuffled = [...allNames].sort(() => Math.random() - 0.5);
        const winners = shuffled.slice(0, pickNum);

        const promises = [];
        for (let i = 0; i < pickNum; i++) {
            promises.push(animateSlot(i, winners[i], allNames));
            await new Promise(r => setTimeout(r, 150)); 
        }

        await Promise.all(promises);
        
        showFinalResult(winners);
        isSpinning = false;
        document.getElementById('spin-btn').disabled = false;
    }

    function animateSlot(idx, finalName, allNames) {
        return new Promise(resolve => {
            const listEl = document.getElementById(`list-${idx}`);
            const rowEl = document.getElementById(`row-${idx}`);

            let count = 0;
            const duration = 20 + (idx * 8); 
            
            const interval = setInterval(() => {
                const randomName = allNames[Math.floor(Math.random() * allNames.length)];
                listEl.innerText = randomName;
                
                count++;
                if (count > duration) {
                    clearInterval(interval);
                    listEl.innerText = finalName;
                    listEl.style.color = "#2ecc71"; // ç¢ºå®šæ™‚ã®ã¿ç·‘ã«ã™ã‚‹
                    rowEl.classList.remove('active');
                    rowEl.classList.add('done');
                    resolve();
                }
            }, 60);
        });
    }

    function showFinalResult(winners) {
        const wrapper = document.getElementById('result-wrapper');
        const textEl = document.getElementById('result-text');
        textEl.innerText = "ã€æŠ½é¸çµæœã€‘\n" + winners.join(' / ');
        wrapper.style.display = 'block';
    }

    function copyResult() {
        const text = document.getElementById('result-text').innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert("çµæœã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        });
    }

    init();
</script>

</body>
</html>